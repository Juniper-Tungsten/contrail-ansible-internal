---
- name: Add contrail yum repository
  yum_repository:
    name: contrail
    description: contrail repo
    baseurl: "{{ contrail_yum_repo }}"
    gpgcheck: no
    enabled: yes
  when: ansible_os_family == "RedHat" and contrail_yum_repo

- name: Add contrail apt repository
  apt_repository:
    repo: "deb {{ contrail_apt_repo }} ./"
    state: present
  when: ansible_os_family == "Debian" and contrail_apt_repo

- name: Install python-setuptools
  package: name=python-setuptools state=present

- name: Make sure pip is installed
  easy_install: name=pip state=present

- name: "Make sure docker-py is installed"
  pip: name=docker-py version={{ docker_py_version }}

- name: "Disable firewalld on redhat systems"
  service: name=firewalld state=stopped enabled=no
  when: ansible_os_family == "RedHat"
  ignore_errors: yes

- name: "Disable iptables on redhat systems"
  service: name=iptables state=stopped enabled=no
  when: ansible_os_family == "RedHat"
  ignore_errors: yes

- name: Create contrailctl config directory
  file: path="{{ contrailctl_config_directory }}" state=directory

- name: Set correct hostname on centos - this should always be only hostname and not hostname.domainname format
  shell: hostnamectl set-hostname "{{ ansible_hostname }}"
  when: ansible_os_family == "RedHat" and ansible_hostname != ansible_nodename
