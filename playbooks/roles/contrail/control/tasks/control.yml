---
- name: configure contrail-control set all entries in DEFAULT section
  ini_file: dest={{ control_conf }} section=DEFAULT option={{ item.key }} value={{ item.value }}  create=yes
  notify:
    - restart control supervisord
    - restart control systemd
  with_dict: "{{ control_infra_configs|combine(control_specific_configs.DEFAULT) }}"

- name: configure contrail-control set entries in IFMAP section
  ini_file: dest={{ control_conf }} section=IFMAP option={{ item.key }} value={{ item.value }}
  notify:
    - restart control supervisord
    - restart control systemd
  with_dict: "{{ control_specific_configs.IFMAP }}"

# If XMPP Auth is enabled, configure target
- name: Configure control conf file if xmpp is enabled
  ini_file: dest={{ control_conf }} section=DEFAULT option={{ item.key }} value={{ item.value }}
  with_dict:
      xmpp_auth_enable: "{{ xmpp_auth_enable }}"
  notify:
    - restart control supervisord
    - restart control systemd
  when: xmpp_auth_enable == true
