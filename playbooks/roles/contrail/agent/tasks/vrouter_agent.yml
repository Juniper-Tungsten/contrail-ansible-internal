---
- name: Configure VIRTUAL-HOST-INTERFACE section of contrail-vrouter-agent.conf
  ini_file: dest={{ vrouter_agent_conf }} section=VIRTUAL-HOST-INTERFACE option={{ item.key }} value={{ item.value }}  create=yes
  notify: restart vrouter-agent
  with_dict:
    name: "{{ vhost_interface }}"
    ip: "{{ vhost_address_with_prefix }}"
    gateway: "{{ vhost_gateway }}"
    physical_interface: "{{ vrouter_physical_interface }}"

- name: Configure DEFAULTS section of contrail-vrouter-agent.conf
  ini_file: dest={{ vrouter_agent_conf }} section=DEFAULTS option={{ item.key }} value={{ item.value }}  create=yes
  notify: restart vrouter-agent
  with_dict:
    platform: "{{ vrouter_platform }}"
    log_file: "{{ vrouter_agent_log }}"
    log_level: "{{ vrouter_agent_log_level }}"
    log_local: "{{ log_local }}"
    physical_interface_mac: "{{ vrouter_physical_interface_mac_address }}"

- name: Configure DISCOVERY section of contrail-vrouter-agent.conf
  ini_file: dest={{ vrouter_agent_conf }} section=DISCOVERY option={{ item.key }} value={{ item.value }}  create=yes
  notify: restart vrouter-agent
  with_dict:
    server: "{{ disc_server_ip }}"
    max_control_nodes: "{{ vrouter_max_control_nodes }}"

- name: Configure NETWORKS section of contrail-vrouter-agent.conf
  ini_file: dest={{ vrouter_agent_conf }} section=NETWORKS option={{ item.key }} value={{ item.value }}  create=yes
  notify: restart vrouter-agent
  with_dict:
    control_network_ip: "{{ vhost_address }}"
