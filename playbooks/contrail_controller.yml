---
- name: "Setup Controller"
  hosts: contrail-controllers

  pre_tasks:
    - include_vars: contrail_controller.yml
      tags: always

  roles:
    - role: common

    - role: contrail/config
      tags: [contrail.controller, contrail.config]

    - role: contrail/control
      tags: [contrail.controller, contrail.controlnode]
      when: enable_control

    - role: contrail/webui
      tags: [contrail.controller, contrail.webui]
      when: enable_webui

  tasks:
    - name: Disable control services in case the it is not enabled
      include_role: name=contrail/control tasks_from=disable-services

    - name: Disable webui services in case the it is not enabled
      include_role: name=contrail/webui tasks_from=disable-services
