---
- name: "Setup Controller"
  hosts: contrail-controllers

  pre_tasks:
    - include_vars: contrail_controller.yml
      tags: always

  roles:
    - role: common

    - role: contrail/config
      tags: [contrail.controller, contrail.config]
      when: enable_config_service

    - role: contrail/control
      tags: [contrail.controller, contrail.controlnode]
      when: enable_control_service

    - role: contrail/webui
      tags: [contrail.controller, contrail.webui]
      when: enable_webui_service

  tasks:
    - name: Disable config services in case it is not enabled
      include_role: name=contrail/config tasks_from=disable-services

    - name: Disable control services in case it is not enabled
      include_role: name=contrail/control tasks_from=disable-services

    - name: Disable webui services in case it is not enabled
      include_role: name=contrail/webui tasks_from=disable-services
